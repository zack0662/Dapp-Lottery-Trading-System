# Dapp-Lottery-Trading-System
Dapp using Solidity and React   
2025秋冬学期 区块链与数字货币作业二

## 如何运行
1. 打开命令行，ganache --deterministic   
输出十个固定账户，这里会使用：  
(0) 0x90F8bf6A479f320ead074411a4B0e7944Ea8c9C1 (管理员账户)  
(1) 0xFFcf8FDEE72ac11b5c542428B35EEF5769C409f0 (普通用户账户）  

2. cd contracts
npx hardhat compile # 编译合约
npx hardhat run scripts/deploy.ts --network ganache # 部署合约

3. cd ..
cd frontend
npm start # 运行前端

## 功能实现分析

1. 用户钱包管理

MetaMask钱包连接与断开

账户切换自动监听

地址显示与格式化

余额实时查询和显示

2. 代币经济系统

初始代币空投：每个新用户可领取500 BET测试代币

代币转账：管理员可以向其他地址转赠代币

余额管理：实时更新和显示用户余额

代币授权：投注前自动授权合约使用代币

3. 赛事管理功能

创建赛事：管理员可以创建新的竞猜项目

- 设置战队名称、描述、票价、截止时间

- 自动生成三个选项（战队A、战队B、平局）

- 激活/停用赛事：管理员控制赛事状态

赛事列表展示：分"进行中"和"所有项目"两种视图

4. 投注系统

- 购买彩票：用户选择投注选项并支付票价

- 多重验证：检查余额、授权状态、赛事状态

- NFT彩票生成：每次投注生成唯一的NFT彩票作为凭证

5. 二级市场交易

- 彩票挂单出售：用户可以自定义价格出售持有的彩票

- 取消挂单：随时取消未售出的挂单

- 市场购买：其他用户可以购买挂单的彩票

- 价格比较：显示买入价与出售价的盈亏情况

6. 开奖与奖金分配

- 管理员开奖：选择获胜方并宣布结果

- 奖金分发：管理员触发奖金分配给所有中奖用户

- 个人奖金领取：中奖用户可以单独领取奖金

- 奖金状态跟踪：记录奖金是否已分发/领取

7. 数据展示与状态管理

- 实时数据刷新：自动更新余额、奖池、彩票状态

- 状态指示：清晰显示赛事状态（进行中/已结束/未开始）

- 错误处理：完善的错误提示和重试机制

- 加载状态：友好的加载提示和进度指示

### 实现方式

- 前端技术栈
React + TypeScript

Web3.js 区块链交互

React Router 路由管理

响应式CSS设计

- 智能合约交互
完整的错误处理和重试机制

Gas费用优化

交易状态实时反馈

合约事件监听

用户体验优化
- 模态框和确认流程

地址缩短显示

实时余额更新

操作状态提示
## 项目运行截图

放一些项目运行截图。

项目运行成功的关键页面和流程截图。主要包括操作流程以及和区块链交互的截图。

## 参考内容

- 课程的参考Demo见：[DEMOs](https://github.com/LBruyne/blockchain-course-demos)。

- 快速实现 ERC721 和 ERC20：[模版](https://wizard.openzeppelin.com/#erc20)。记得安装相关依赖 ``"@openzeppelin/contracts": "^5.0.0"``。

- 如何实现ETH和ERC20的兑换？ [参考讲解](https://www.wtf.academy/en/docs/solidity-103/DEX/)

如果有其它参考的内容，也请在这里陈列。
